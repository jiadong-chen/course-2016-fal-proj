
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>D3: The shortest distance distribution</title>
		<script type="text/javascript" src="d3/d3.v3.js"></script>
		<style type="text/css">
			/* No style rules here yet */		
		</style>
	</head>
	<body>
	
		<p>Click on the text to show the transition from the shortest distance distribution of crime and high-valued properties to that of high-valued properties and crime </p>
			
		<script type="text/javascript">

			//Width and height
			var w = 1000;
			var h = 500;
			
			var dataset = [0.0, 0.2059670149687146, 0.20073734282683686, 0.26183283879029906, 0.3424062322916901, 0.49538746245625104, 0.4478633006036488, 0.12130068696960476, 0.13131255022614863, 0.15137815191059817, 0.16190350535432907, 0.16617338014299915, 0.1732065177639815, 0.17263173440242927, 0.1720845068058263, 0.17158810512955186, 0.1710359459945628, 0.17022096703765027, 0.1697993874469776, 0.174710527560984, 0.1788834444929636, 0.17952032451021777, 0.180255471320535, 0.17966133534670042, 0.18058895996523408, 0.07009257405538612, 0.18123142954772362, 0.18296918613103294, 0.18333342074455503, 0.18089362366396095, 0.17808952892905303, 0.16276369899453827, 0.1395177309379047, 0.1395177309379047, 0.11673435194523353, 0.11302612944696784, 0.10940414731244309, 0.10578580179480465, 0.100236396221871, 0.09745831845940055, 0.18939935459976812, 0.18628803617806308, 0.18325533972554206, 0.18016293288470067, 0.32695969182909607, 0.17372784036271025, 0.02201567603367813, 0.11360114465797128, 0.2236091379681231, 0.1672828651196997, 0.35995513802500384, 0.303803225635156, 0.3582169311592225, 0.3543916958661299, 0.23462971162242088, 0.3593807500482505, 0.20519592033651526, 0.2983988219636571, 0.31723165515894886, 0.4226137350371246, 0.5935595428132154, 0.53251677497524, 0.5367361613628208, 0.5390383529369069, 0.40445018873656213, 0.40660218809617105, 0.4465372589404354, 0.6021379849981284, 0.5892626286918125, 0.570959255240496, 0.5538104712618128, 0.5788116156653672, 0.6532965818903328, 0.6517024419730462, 0.7481479906817696, 0.6570300104445966, 0.7867466430658951, 0.6078014303910529, 0.5974440818733995, 0.59043623703713, 0.5920846118753077, 0.5937168106134522, 0.6223016857765672, 0.6145661088336226, 0.610958976934564, 0.2565213101112838, 0.3749447737403722, 0.38682327840057273, 0.4003966819122542, 0.4028980752099203, 0.4039782768058338, 0.4098216204877622, 0.4404127992917528, 0.47815468831311525, 0.0882562173110563, 0.09675883429989307, 0.046090001554634656, 0.06030942587103043, 0.054200271708879776, 0.1141218266505215, 0.12164698958560217, 0.1248829925018017, 0.19728323793475486, 0.1629465364891615, 0.16568852183126265, 0.16843475566570118, 0.16926373067575046, 0.16962648887052828, 0.18569156185113744, 0.024604216711478482, 0.1859161683373305, 0.189583117431025, 0.19324481140273522, 0.19682997317474588, 0.2004482678234823, 0.20407302907620542, 0.20774411404691162, 0.2113683846234121, 0.15679260163272923, 0.8673949968648967, 0.8796281325756176, 0.829130696649802, 0.9412327266384934, 0.9935275971004214, 0.9956106522944036, 0.9977877850873892, 1.0, 0.9554908244068377, 0.8794115774360114, 0.8829906451250724, 0.5898734033781994, 0.5851536460663656, 0.6334136950501776, 0.8728716208915603, 0.8728716208915603, 0.8728716208915603, 0.8728716208915603, 0.8728716208915603, 0.8728716208915603, 0.8728716208915603, 0.8728716208915603, 0.4206846006199362, 0.42243863771619067, 0.4241720568221219, 0.36995136125780453, 0.3724622428158179, 0.37306598469894175, 0.37449238230008314, 0.379192434837763, 0.32318502467364957, 0.3212856895500808, 0.3252979547123451, 0.3410988097559796, 0.3523759880199625, 0.3534902035728176, 0.3633450205812041, 0.3737162741849913, 0.38398298909705775, 0.3893462427085327, 0.4001221670992911, 0.3932579761309015, 0.3871638840517889, 0.4411124797643064, 0.43976674500137053, 0.633844886360903, 0.6314927477378586, 0.6294481053362223, 0.6277373222451513, 0.6258912658694965, 0.6191916908232392, 0.6174388952350564, 0.6161517694918404, 0.6148785319647514, 0.6172632463082143, 0.6186594855842011, 0.6200745104503279, 0.5379919710394434, 0.5304843996791279, 0.5295276348437237, 0.5285497124957154, 0.5274986028434334, 0.5252209709465125, 0.5241943680084022, 0.5229954540446474, 0.5215241873836368, 0.520568619831074, 0.5195882564752443, 0.5177647528497566, 0.513212166233229, 0.5151410007020683, 0.479499704640174, 0.5028891370357964, 0.5100548556688262, 0.5380269311953847, 0.5328498774491404, 0.6409462664629986, 0.6238489024193709, 0.555052267592919, 0.7671644251572696, 0.7665733002295664, 0.7654290567336826, 0.7643005493488526, 0.7631121982570555, 0.7618301036291324, 0.7604768609690983, 0.7600634920337727, 0.7723239536679853, 0.7487223587014629, 0.7581588489703207, 0.7509841740166746, 0.7608691329866419, 0.7197415645709929, 0.7190212213414617, 0.7110719989148011, 0.7043834597004823, 0.7474527755404548, 0.7403658447747589, 0.6977797657883001, 0.7246814405091692, 0.7148596992698294, 0.7203838046695725, 0.7200954582620087, 0.7247447027046355, 0.6544549804101004, 0.6300745213496012, 0.6454716695057507, 0.4224805140850194, 0.4061563583026428, 0.4067017551929238, 0.4262815963106224, 0.38525059617753005, 0.3887701933386579, 0.39044660004990095, 0.39056408639406365, 0.41542846794617116, 0.4140449233236891, 0.41118409802912304, 0.41384224132584463, 0.4147066351203839, 0.3987267476978128, 0.39691851230525566, 0.3951797036789526, 0.3933546343582858, 0.4425854117771407, 0.4415936473324838, 0.45921668070309946, 0.4447731535345195, 0.4458663266308199, 0.38901041025717054, 0.3848413341040364, 0.3948269306754704, 0.36498696919365176, 0.36858870305413444, 0.3719068846300803, 0.3875358939290259, 0.39411427008676264, 0.39088941142628963, 0.38976684471082335, 0.38847335061011273, 0.40783736762001693, 0.4056449363706323, 0.4021134250746462, 0.35077129752576647, 0.3568363297362249, 0.36269621719868467, 0.3725892750106995, 0.3795835618551256, 0.3804880234773909, 0.3812485598488372, 0.3780024845595241, 0.3771125429620055, 0.40588064740651164, 0.4059252529488145, 0.17667637912951745, 0.1421217447764633, 0.07025661206369954, 0.07803368275694447, 0.04566994820317825, 0.14723730818454664, 0.14012144989278033, 0.11249727639714135, 0.10462838755898592, 0.02703036940086574, 0.019923701620692718, 0.15499292501955553, 0.2359048161838029, 0.2547041899128838, 0.24296912087042463, 0.24439735503365462, 0.1432035820143633, 0.17369172698601218, 0.16950950377962304, 0.16657045287369324, 0.18222492176090802, 0.18842351650718445, 0.19688365117112952, 0.20613659686365415, 0.3813103528886614, 0.377968620791005, 0.37688119536833603, 0.37584661550215104, 0.37475701798388644, 0.3737114137222455, 0.37261327400293076, 0.371503671463257, 0.3703988637720463, 0.3693700238470026, 0.36829027877659687, 0.367207649183643, 0.36613136608249125, 0.3640125761402371, 0.22081429101133473, 0.22377984485575733, 0.22734843220393683, 0.2896646179589583, 0.23111552950435135, 0.2335251491634602, 0.23792267334578254, 0.23982733309325682, 0.24174522118864278, 0.24347193066113607, 0.18346312595077258, 0.18377609076504003, 0.18384187679428404, 0.18396092521461507, 0.25206400478716234, 0.2507772159748168, 0.24948064800368366, 0.22554928938347657, 0.23716246501275048, 0.23920683646205815, 0.24393057020994363, 0.24953557953747915, 0.25370937690091355, 0.25868686294617754, 0.2743783679700223, 0.27738857741023626, 0.2790371862307051, 0.2949095517409962, 0.27271286703697095, 0.2741763520907015, 0.27746762130416724, 0.28701686573402535, 0.24248805186662, 0.24119882351919603, 0.2399036763429711, 0.23860140239022265, 0.2372643976589241, 0.2259081046177601, 0.2419555922331435, 0.23482462859576053, 0.2926533710125365, 0.27591288875281816, 0.26009530166433403, 0.2311213081677769, 0.5337062558692774];

			
			var xScale = d3.scale.ordinal()
							.domain(d3.range(dataset.length))
							.rangeRoundBands([0, w], 0.05);

			var yScale = d3.scale.linear()
							.domain([0, d3.max(dataset)])
							.range([0, h]);
			
			//Create SVG element
			var svg = d3.select("body")
						.append("svg")
						.attr("width", w)
						.attr("height", h);

			//Create bars
			svg.selectAll("rect")
			   .data(dataset)
			   .enter()
			   .append("rect")
			   .attr("x", function(d, i) {
			   		return xScale(i);
			   })
			   .attr("y", function(d) {
			   		return h - yScale(d);
			   })
			   .attr("width", xScale.rangeBand())
			   .attr("height", function(d) {
			   		return yScale(d);
			   })
			   .attr("fill", function(d) {
					return "rgb(0, 0, " + (d * 10) + ")";
			   });

			//Create labels
			




			//On click, update with new data			
			d3.select("p")
				.on("click", function() {

					//New values for dataset
											//Count original length of dataset
					dataset = [0.1560484445015499, 0.1364725036959783, 0.11125714093575705, 1.0, 0.014642271756418215, 0.09524239733266629, 0.016363868494983752, 0.030653718149937285, 0.0]; 						 				//Initialize empty array
					
					var numValues = dataset.length;
					xScale.domain(d3.range(dataset.length));
					yScale.domain([0, d3.max(dataset)]);	
					

					//Update all rects
					var bars=svg.selectAll("rect")
					   .data(dataset);
					bars.enter()								//References the enter selection (a subset of the update selection)
						.append("rect")							//Creates a new rect
						.attr("x", w)							//Sets the initial x position of the rect beyond the far right edge of the SVG
						.attr("y", function(d) {				//Sets the y value, based on the updated yScale
							return h - yScale(d);
						})
						.attr("width", xScale.rangeBand())		//Sets the width value, based on the updated xScale
						.attr("height", function(d) {			//Sets the height value, based on the updated yScale
							return yScale(d);
						})
						.attr("fill", function(d) {				//Sets the fill value
							return "rgb(0, 0, " + (d * 10) + ")";
						});

					bars.transition()							//Initiate a transition on all elements in the update selection (all rects)
						.duration(500)
						.attr("x", function(d, i) {				//Set new x position, based on the updated xScale
							return xScale(i);
						})
						.attr("y", function(d) {				//Set new y position, based on the updated yScale
							return h - yScale(d);
						})
						.attr("width", xScale.rangeBand())		//Set new width value, based on the updated xScale
						.attr("height", function(d) {			//Set new height value, based on the updated yScale
							return yScale(d);
						});   

					//Update all labels
					
					bars.exit()				//References the exit selection (a subset of the update selection)
						.transition()		//Initiates a transition on the one element we're deleting
						.duration(500)
						.attr("x", w)		//Move past the right edge of the SVG
						.remove();
					   				
				});

			
		</script>
	</body>
</html>